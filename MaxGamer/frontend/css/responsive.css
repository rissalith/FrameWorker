/**
 * 全局响应式样式
 * 适配不同设备和浏览器（特别是Safari）
 */

/* ==================== 基础响应式设置 ==================== */

/* 确保所有元素使用border-box */
*, *::before, *::after {
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
}

/* Safari iOS特定优化 - 只在移动端应用 */
@supports (-webkit-touch-callout: none) {
    @media (max-width: 768px) {
        /* iOS Safari 视口高度修复 */
        body {
            min-height: -webkit-fill-available;
        }
        
        /* 禁用iOS Safari的自动缩放 */
        input, textarea, select {
            font-size: 16px !important; /* 防止iOS自动缩放 */
        }
    }
}

/* 防止横向滚动 */
html, body {
    overflow-x: hidden;
    max-width: 100vw;
}

/* ==================== 图片和媒体响应式 ==================== */

img, video, iframe {
    max-width: 100%;
    height: auto;
    display: block;
}

/* Safari视频优化 */
video {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
}

/* ==================== 触摸优化 ==================== */

/* 移除移动端点击高亮 */
* {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
}

/* 可点击元素保持指针样式 */
button, a, input[type="submit"], input[type="button"] {
    cursor: pointer;
    -webkit-user-select: none;
    user-select: none;
}

/* 文本输入保持文本选择 */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="search"],
textarea {
    -webkit-user-select: text;
    user-select: text;
}

/* ==================== 字体响应式 ==================== */

/* 基础字体大小 - 桌面 */
html {
    font-size: 16px;
}

/* 平板 */
@media (max-width: 1024px) {
    html {
        font-size: 15px;
    }
}

/* 手机 */
@media (max-width: 768px) {
    html {
        font-size: 14px;
    }
}

/* 小屏手机 */
@media (max-width: 480px) {
    html {
        font-size: 14px;
    }
}

/* ==================== 容器响应式 ==================== */

.container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

@media (max-width: 768px) {
    .container {
        padding: 0 15px;
    }
}

@media (max-width: 480px) {
    .container {
        padding: 0 12px;
    }
}

/* ==================== 按钮响应式 ==================== */

button, .btn {
    min-height: 44px; /* iOS推荐的最小触摸目标 */
    min-width: 44px;
}

@media (max-width: 768px) {
    button, .btn {
        min-height: 48px; /* 移动端增大触摸区域 */
    }
}

/* ==================== 表单响应式 ==================== */

input, textarea, select {
    width: 100%;
    max-width: 100%;
}

/* 防止iOS Safari自动缩放 */
@media (max-width: 768px) {
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="search"],
    input[type="tel"],
    input[type="url"],
    textarea,
    select {
        font-size: 16px !important;
    }
}

/* ==================== 固定定位元素的安全区域适配 ==================== */

/* iOS安全区域支持 */
@supports (padding: max(0px)) {
    .fixed-top {
        padding-top: max(0px, env(safe-area-inset-top));
    }
    
    .fixed-bottom {
        padding-bottom: max(0px, env(safe-area-inset-bottom));
    }
    
    .fixed-left {
        padding-left: max(0px, env(safe-area-inset-left));
    }
    
    .fixed-right {
        padding-right: max(0px, env(safe-area-inset-right));
    }
}

/* ==================== 横屏模式优化 ==================== */

@media (max-height: 600px) and (orientation: landscape) {
    /* 横屏时减小垂直间距 */
    .auth-page,
    .main-content {
        padding-top: 10px;
        padding-bottom: 10px;
    }
    
    /* 横屏时优化表单间距 */
    .form-group {
        margin-bottom: 8px;
    }
}

/* ==================== 高分辨率屏幕优化 ==================== */

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    /* Retina屏幕优化 */
    img {
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
    }
}

/* ==================== 打印样式 ==================== */

@media print {
    /* 隐藏不需要打印的元素 */
    .no-print,
    nav,
    .sidebar,
    .interaction-buttons,
    .video-container {
        display: none !important;
    }
    
    /* 优化打印布局 */
    body {
        background: white !important;
        color: black !important;
    }
    
    a {
        text-decoration: underline;
    }
}

/* ==================== 可访问性优化 ==================== */

/* 减少动画（用户偏好） */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* 高对比度模式 */
@media (prefers-contrast: high) {
    * {
        border-color: currentColor !important;
    }
}

/* 深色模式支持（预留） */
@media (prefers-color-scheme: dark) {
    /* 深色模式样式可以在这里添加 */
}

/* ==================== 特定设备优化 ==================== */

/* iPhone X/11/12/13/14 系列 */
@supports (padding: max(0px)) {
    @media only screen 
        and (device-width: 375px) 
        and (device-height: 812px) 
        and (-webkit-device-pixel-ratio: 3) {
        /* iPhone X/XS/11 Pro/12 Mini/13 Mini 特定优化 */
        body {
            padding-bottom: env(safe-area-inset-bottom);
        }
    }
    
    @media only screen 
        and (device-width: 414px) 
        and (device-height: 896px) 
        and (-webkit-device-pixel-ratio: 2) {
        /* iPhone XR/11 特定优化 */
        body {
            padding-bottom: env(safe-area-inset-bottom);
        }
    }
}

/* iPad优化 */
@media only screen 
    and (min-device-width: 768px) 
    and (max-device-width: 1024px) {
    /* iPad特定优化 */
    .auth-page {
        padding: 40px;
    }
}

/* ==================== 工具类 ==================== */

/* 显示/隐藏工具类 */
.hide-mobile {
    display: block;
}

.show-mobile {
    display: none;
}

@media (max-width: 768px) {
    .hide-mobile {
        display: none !important;
    }
    
    .show-mobile {
        display: block !important;
    }
}

/* 文本对齐 */
@media (max-width: 768px) {
    .text-center-mobile {
        text-align: center !important;
    }
}

/* 间距工具类 */
@media (max-width: 768px) {
    .p-mobile-0 { padding: 0 !important; }
    .p-mobile-1 { padding: 0.5rem !important; }
    .p-mobile-2 { padding: 1rem !important; }
    
    .m-mobile-0 { margin: 0 !important; }
    .m-mobile-1 { margin: 0.5rem !important; }
    .m-mobile-2 { margin: 1rem !important; }
}

/* ==================== 性能优化 ==================== */

/* 硬件加速 */
.gpu-accelerated {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    will-change: transform;
}

/* 平滑滚动 */
html {
    scroll-behavior: smooth;
}

@media (prefers-reduced-motion: reduce) {
    html {
        scroll-behavior: auto;
    }
}

/* ==================== Safari特定修复 ==================== */

/* 修复Safari的flexbox bug */
@supports (-webkit-touch-callout: none) {
    .flex-container {
        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
    }
    
    .flex-item {
        -webkit-box-flex: 1;
        -webkit-flex: 1;
        flex: 1;
    }
}

/* 修复Safari的position: sticky */
@supports (-webkit-touch-callout: none) {
    .sticky {
        position: -webkit-sticky;
        position: sticky;
    }
}

/* 修复Safari的backdrop-filter */
@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none) {
    .blur-bg {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
    }
}